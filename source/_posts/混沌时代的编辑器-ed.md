---
title: '混沌时代的编辑器: ed'
date: 2021-01-14 12:06:04
tags:
---
Unix操作系统的作者Ken Thompson于1971年8月发布ed的第一个版本，是Unix操作系统三个最基础的组件。
哪三个组件？编译器、ed和shell。

切换至输入模式的命令如下：
```
a，在当前行的下一行开始插入文字；
i，在当前行的上一行开始插入文字；
c，抹除当前行的所有文字，重新输入。
```
注意 c 命令的危险性。

切换至输入模式后，就请随意地打字吧，回车也会忠实地写入文件。
缺点是没有办法修改回车符以前的输错的文字。
如果想修改，必须退出当前的输入模式再尝试修改。

如果想退出输入模式，在新行输入 `.` 即可，就是英文句点。

以下导航命令应当在命令模式下使用。
```
直接输入行号并回车，跳转到对应行，并回显对应行的文字（不带行号）。
输入回车，会跳转到下一行，并回显对应行的文字（不带行号）。
输入 . ，会重复显示当前行的文字（不带行号）。
输入 n，会回显当前行的文字（带行号）。
```

以下是一个 Linux ed 完整实例解析：
```shell
% ed test.txt     <-- 编辑文本test.txt
test.txt: No such file or directory   <--如果文件不存在,就生成该文件
a           <--a追加编辑,进入编辑模式
one         <--在新行里编辑
two         <--在新行里编辑
three       <--在新行里编辑
.           <--保存编辑的数据,退出编辑模式
1           <--展示指定行号的数据,第1行
one         <--
2           <--展示指定行号的数据,第2行
two         <--
3           <--展示指定行号的数据,第3行
three       <--
1,2         <---指定多行时仅展示最后指定行的数据
two         <---
1,2l        <---l可以展示多行数据,已$结尾
One$        <---
two$        <---
,l          <--",l"是"1,$l"的简写,展示全部行的数据,已$结尾
one$        <--
two$        <--
three$      <--
1i          <--i向前行插入编辑,"1i"是第1行前插入编辑,进入编辑模式
zore        <--在新行里编辑数据
.           <--保存编辑数据,退出编辑模式
1           <--展示指定行号的数据,第1行
zore        <--
,l          <--
zore$       <--
one$        <--
two$        <--
three$      <--
1d          <--d删除行,"1d"删除第1行
,l          <--
one$        <--
two$        <--
three$      <--
1,2d        <--d删除行,"1,2d"删除多行
,l          <--
three$      <--
u           <--u撤销上一次的编辑,就是上一次的文本变动
,l          <--
one$        <--
two$        <--
three$      <--
1t1         <--{x,y}tz 多行复制追加到第z行之后
,l          <--
one$        <--原第1行
one$        <--新插入的行数据
two$        <--
three$      <--
1d          <--d删除行,
1m3         <--{x,y}mz 多行复制覆盖到第z行开始后的数据
,l          <--
two$        <--
three$      <--
one$        <--第3行被覆盖
u           <--u撤销上一次的编辑
1m4         <--覆盖不存在的行
?           <--?报错
1,$s/o/O/g  <--s行内替换,当做行内修改用,可指定多行
,l
One$        <--受替换影响
twO$        <--受替换影响
three$      <--未受影响
wq          <--w为保存编辑到文本,q为退出编辑器
14          <--展示文本内字符数量
%           <--已退到命令行中
```

这是文件的内容是：
```shell
$ cat text.text
One
twO
three
```

后续影响:
```
ex (文本编辑器)，最初是扩展版本的ed。
vi，基于ex的可视全面屏编辑器.
sed，基于ed内脚本特征的标准UNIX流式编辑器。
```
